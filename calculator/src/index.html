<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8" />
    <title>Калькулятор</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        :root {
            --bg: #0f172a;
            --panel: #1f2937;
            --btn: #111827;
            --btn-light: #e5e7eb;
            --accent: #f97316;
            --text: #f8fafc;
            --danger: #ef4444;
            --radius: 1rem;
        }

        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            background: radial-gradient(circle at top, #1f2937, #0f172a 60%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            color: var(--text);
        }

        .calculator {
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 1.5rem;
            width: min(360px, 100%);
            box-shadow: 0 20px 40px rgba(0,0,0,.3);
            overflow: hidden;
        }

        .display {
            background: rgba(15, 23, 42, .6);
            padding: 1.4rem 1rem .5rem;
            text-align: right;
            min-height: 4.5rem;
            position: relative;
        }

        .expression {
            font-size: .9rem;
            opacity: .6;
            min-height: 1.2rem;
            word-break: break-all;
        }

        .result {
            font-size: 2.2rem;
            font-weight: 600;
            word-break: break-all;
        }

        .error {
            color: var(--danger);
            font-size: .8rem;
            text-align: right;
            padding: .25rem 1rem 0;
            min-height: 1rem;
        }

        .keys {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: .5rem;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.25);
        }

        button {
            border: none;
            border-radius: .75rem;
            padding: .9rem;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform .1s ease-out, background .1s;
            background: rgba(15, 23, 42, 0.4);
            color: var(--text);
        }

        button:active {
            transform: translateY(1px);
        }

        .btn-operator {
            background: rgba(249, 115, 22, .12);
            color: var(--accent);
            font-weight: 600;
        }

        .btn-equal {
            background: var(--accent);
            color: #fff;
            grid-column: span 2;
        }

        .btn-clear {
            background: rgba(239, 68, 68, .12);
            color: #fee2e2;
        }

        .btn-backspace {
            background: rgba(148, 163, 184, .12);
        }

        @media (hover:hover) {
            button:hover {
                background: rgba(255,255,255,.04);
            }
            .btn-operator:hover {
                background: rgba(249, 115, 22, .22);
            }
            .btn-clear:hover {
                background: rgba(239, 68, 68, .22);
            }
            .btn-equal:hover {
                background: #fb923c;
            }
        }
    </style>
</head>
<body>
<div class="calculator">
    <div class="display">
        <div id="expression" class="expression"></div>
        <div id="result" class="result">0</div>
    </div>
    <div id="error" class="error"></div>
    <div class="keys">
        <button class="btn-clear" data-action="clear">C</button>
        <button class="btn-backspace" data-action="backspace">⌫</button>
        <button class="btn-operator" data-value="/">÷</button>
        <button class="btn-operator" data-value="*">×</button>

        <button data-value="7">7</button>
        <button data-value="8">8</button>
        <button data-value="9">9</button>
        <button class="btn-operator" data-value="-">−</button>

        <button data-value="4">4</button>
        <button data-value="5">5</button>
        <button data-value="6">6</button>
        <button class="btn-operator" data-value="+">+</button>

        <button data-value="1">1</button>
        <button data-value="2">2</button>
        <button data-value="3">3</button>
        <button data-value=".">.</button>

        <button data-value="0">0</button>
        <button data-value="(">(</button>
        <button data-value=")">)</button>
        <button class="btn-equal" data-action="calculate">=</button>
    </div>
</div>

<script>
    const exprEl = document.getElementById('expression');
    const resultEl = document.getElementById('result');
    const errorEl = document.getElementById('error');

    // добавляем символ в выражение
    function appendToExpression(val) {
        errorEl.textContent = '';
        exprEl.textContent += val;
    }

    function clearAll() {
        exprEl.textContent = '';
        resultEl.textContent = '0';
        errorEl.textContent = '';
    }

    function backspace() {
        errorEl.textContent = '';
        exprEl.textContent = exprEl.textContent.slice(0, -1);
    }

    function calculate() {
        const expression = exprEl.textContent;
        if (!expression.trim()) {
            return;
        }

        if (/[+\-*/.]$/.test(expression)) {
            errorEl.textContent = 'Неповний вираз';
            return;
        }

        try {

            const value = Function('"use strict"; return (' + expression + ')')();

            if (!isFinite(value)) {
                errorEl.textContent = 'Помилка: ділення на нуль';
                resultEl.textContent = '∞';
                return;
            }

            resultEl.textContent = value;
            errorEl.textContent = '';
        } catch (e) {
            errorEl.textContent = 'Некоректний вираз';
        }
    }


    document.querySelector('.keys').addEventListener('click', (e) => {
        const btn = e.target;
        if (btn.tagName !== 'BUTTON') return;

        const action = btn.dataset.action;
        const value = btn.dataset.value;

        if (action === 'clear') {
            clearAll();
        } else if (action === 'backspace') {
            backspace();
        } else if (action === 'calculate') {
            calculate();
        } else if (value) {
            appendToExpression(value);
        }
    });


    document.addEventListener('keydown', (e) => {
        const key = e.key;

        if (/[0-9+\-*/().]/.test(key)) {
            appendToExpression(key);
        } else if (key === 'Enter' || key === '=') {
            e.preventDefault();
            calculate();
        } else if (key === 'Backspace') {
            backspace();
        } else if (key.toLowerCase() === 'c' && e.ctrlKey === false) {
            clearAll();
        }
    });
</script>
</body>
</html>
